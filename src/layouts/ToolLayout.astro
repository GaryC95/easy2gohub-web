---
import BaseLayout from "./BaseLayout.astro";
import AppSidebar from "../components/ui/AppSidebar.astro";
import AdsSlot from "../components/ads/AdsSlot.astro";

const {
  title,
  description,
  canonical,
  adsProfile = "default", // "default" | "light" | "none"
} = Astro.props;

const showAds = adsProfile !== "none";
---

<BaseLayout title={title} description={description} canonical={canonical}>
  {/* AdSense site verification & global loader (PROD only) */}
  {import.meta.env.PROD && (
    <script
      async
      src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1409463603356964"
      crossorigin="anonymous"
    ></script>
  )}

  <div class="flex h-screen overflow-hidden">
    <AppSidebar />

    <main class="flex-1 flex flex-col overflow-y-auto">
      <header class="sticky top-0 z-40 px-8 py-4 glass border-b border-white/40 flex items-center justify-between gap-6">
        <div class="min-w-0">
          <h1 class="text-3xl md:text-4xl font-extrabold text-slate-900 tracking-tight truncate">
            {title}
          </h1>
          <p class="text-slate-500 mt-1 text-sm md:text-base max-w-3xl">
            {description}
          </p>
          {canonical ? (
            <p class="text-[11px] text-slate-400 mt-1 font-semibold truncate">
              {canonical}
            </p>
          ) : null}
        </div>

        <div class="hidden md:flex items-center gap-3">
          <a
            href="/tools/"
            class="px-4 py-2 rounded-xl bg-primary text-white text-sm font-extrabold shadow-lg shadow-primary/25 hover:shadow-primary/35 transition"
          >
            All Tools
          </a>
        </div>
      </header>

      <div class="flex-1 p-8 flex gap-8 max-w-7xl mx-auto w-full items-start">
        {/* Main tool area */}
        <div class="flex-1 space-y-8">
          <slot />

          {showAds ? (
            <slot name="ads-below-tool">
              <AdsSlot label="Sponsored" height="h-40" />
            </slot>
          ) : null}

          <slot name="below-main" />
        </div>

        {/* Right sidebar */}
        <aside class="w-80 space-y-6 flex-shrink-0 hidden lg:block">
          <slot name="settings" />

          {showAds ? (
            <slot name="ads-right">
              <AdsSlot label="Sponsored" height="h-56" />
            </slot>
          ) : null}
        </aside>
      </div>
    </main>
  </div>
</BaseLayout>
