---
import ToolLayout from "../../layouts/ToolLayout.astro";
import AdsSlot from "../../components/ads/AdsSlot.astro";
import {
  CATEGORY_LABEL,
  CATEGORY_DESC,
  getToolsByCategory,
  type Category,
} from "../../data/tools";

export async function getStaticPaths() {
  return Object.keys(CATEGORY_LABEL).map((category) => ({
    params: { category },
  }));
}

const { category } = Astro.params as { category: Category };
const tools = getToolsByCategory(category);
---

<ToolLayout
  title={CATEGORY_LABEL[category]}
  description={CATEGORY_DESC[category]}
  settingsSlot={null}
>
  <section class="space-y-10 max-w-5xl">
    <!-- Intro -->
    <header>
      <h1 class="text-4xl font-extrabold tracking-tight mb-3">
        {CATEGORY_LABEL[category]}
      </h1>
      <p class="text-slate-500 text-lg max-w-3xl">
        {CATEGORY_DESC[category]}
      </p>
    </header>

    <!-- Tools Grid -->
    <div class="grid sm:grid-cols-2 lg:grid-cols-3 gap-6">
      {tools.map((tool, i) => (
        <>
          <a
            href={`/${tool.category}/${tool.slug}/`}
            class="tool-card p-6 flex flex-col gap-4 hover:shadow-xl transition-all"
          >
            <div class="flex items-center gap-3">
              <span class="material-symbols-outlined text-primary text-2xl">
                {tool.icon}
              </span>
              <h2 class="font-bold text-lg">{tool.title}</h2>
            </div>
            <p class="text-sm text-slate-500 flex-1">
              {tool.description}
            </p>
            <div class="flex gap-2 mt-auto">
              {tool.tags.map((tag) => (
                <span class="px-2 py-1 text-[10px] font-bold uppercase rounded bg-slate-100 text-slate-500">
                  {tag}
                </span>
              ))}
            </div>
          </a>

          <!-- Mid-feed Ad -->
          {i === 2 && (
            <div class="sm:col-span-2 lg:col-span-3">
              <AdsSlot label="Sponsored" />
            </div>
          )}
        </>
      ))}
    </div>

    <!-- FAQ / SEO block -->
    <section class="space-y-4 max-w-3xl">
      <h2 class="text-xl font-bold">
        Frequently Asked Questions
      </h2>
      <p class="text-sm text-slate-500">
        All tools in this category run directly in your browser.
        Files are never uploaded to a server.
      </p>
    </section>
  </section>

  <slot name="ads-footer">
    <AdsSlot label="Sponsored" />
  </slot>
</ToolLayout>
